# Generated by Django 4.0.1 on 2022-01-29 04:44

from django.db import migrations, models


def is_private_to_public_flip(apps, schema_editor):
    Problem = apps.get_model("gameserver", "Problem")
    for row in Problem.objects.all():
        row.is_public = not row.is_public
        row.save(update_fields=["is_public"])

    Contest = apps.get_model("gameserver", "Contest")
    for row in Contest.objects.all():
        row.is_public = not row.is_public
        row.save(update_fields=["is_public"])

    Organization = apps.get_model("gameserver", "Organization")
    for row in Organization.objects.all():
        row.is_public = not row.is_public
        row.save(update_fields=["is_public"])


class Migration(migrations.Migration):

    dependencies = [
        ("gameserver", "0005_problemfile_checksum"),
    ]

    operations = [
        migrations.RenameField(
            model_name="contest",
            old_name="is_private",
            new_name="is_public",
        ),
        migrations.RenameField(
            model_name="organization",
            old_name="is_private",
            new_name="is_public",
        ),
        migrations.RenameField(
            model_name="problem",
            old_name="is_private",
            new_name="is_public",
        ),
        migrations.AlterField(
            model_name="organization",
            name="is_public",
            field=models.BooleanField(default=True),
        ),
        migrations.AlterField(
            model_name="problem",
            name="is_public",
            field=models.BooleanField(default=False),
        ),
        migrations.RunPython(is_private_to_public_flip, reverse_code=is_private_to_public_flip),
    ]
